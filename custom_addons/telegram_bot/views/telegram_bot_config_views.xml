<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_telegram_bot_config_form" model="ir.ui.view">
        <field name="name">telegram.bot.config.form</field>
        <field name="model">telegram.bot.config</field>
        <field name="arch" type="xml">
            <form string="Конфигурация Telegram бота">
                <header>
                    <button name="action_set_webhook" string="Установить Webhook" type="object" class="oe_highlight"/>
                    <button name="action_delete_webhook" string="Удалить Webhook" type="object"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="bot_name"/>
                            <field name="bot_token" password="True" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"/>
                            <field name="webhook_secret" password="True"/>
                            <field name="active" widget="boolean_toggle"/>
                        </group>
                        <group>
                            <field name="webhook_url" readonly="1"/>
                            <field name="operator_user_ids" widget="many2many_tags"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Инструкция">
                            <div class="alert alert-info" role="alert">
                                <h4>Как настроить бота:</h4>
                                <ol>
                                    <li>Создайте бота через <a href="https://t.me/BotFather" target="_blank">@BotFather</a> в Telegram</li>
                                    <li>Получите Bot Token от BotFather</li>
                                    <li>Введите Bot Token в поле выше</li>
                                    <li>Придумайте и введите Webhook Secret (любая строка для безопасности)</li>
                                    <li>Нажмите "Установить Webhook"</li>
                                    <li>Активируйте бота</li>
                                </ol>
                                <p><strong>Важно:</strong> Убедитесь, что ваш Odoo доступен из интернета для работы webhook.</p>
                            </div>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_telegram_bot_config" model="ir.actions.act_window">
        <field name="name">Конфигурация Telegram бота</field>
        <field name="res_model">telegram.bot.config</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
        <field name="domain">[]</field>
    </record>
</odoo>

